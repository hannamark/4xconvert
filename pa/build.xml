<?xml version="1.0" encoding="UTF-8"?>

<!-- ====================================================================== -->
<!-- Ant build file (http://ant.apache.org/) for Ant 1.6.2 or above.        -->
<!-- ====================================================================== -->

<project name="pa" default="package" basedir=".">
    <property file="${basedir}/build.properties"/>

	<!-- ====================================================================== -->
	<!-- Cleaning up target                                                     -->
	<!-- ====================================================================== -->

	<target name="clean" description="Clean the output directory">
        <ant target="clean" dir="pa-ejb"/>
        <ant target="clean" dir="pa-web"/>
        <ant target="clean" dir="pa-ear"/>
	</target>

	<!-- ====================================================================== -->
	<!-- Compilation target                                                     -->
	<!-- ====================================================================== -->

	<target name="compile" description="Compile the code">
        <ant target="compile" dir="pa-ejb"/>
        <ant target="compile" dir="pa-web"/>
        <ant target="compile-tests" dir="pa-ejb"/>
        <ant target="compile-tests" dir="pa-web"/>
	</target>

	<!-- ====================================================================== -->
	<!-- Run all tests                                                          -->
	<!-- ====================================================================== -->

	<target name="test" description="Run all tests">
        <ant target="test-all" dir="pa-ejb"/>
        <ant target="test-all" dir="pa-web"/>
        </target>

	<!-- ====================================================================== -->
	<!-- Package target                                                         -->
	<!-- ====================================================================== -->

	<target name="package" description="Package the application">
        <ant target="package" dir="pa-ejb"/>
        <ant target="package" dir="pa-web"/>
	</target>

    <!-- ====================================================================== -->
    <!-- Deploy locally                                                         -->
    <!-- ====================================================================== -->

    <target name="deploy" description="Deploys the application">
        <fail unless="jboss.deploy.directory" message="Property jboss.deploy.directory not set.  Check build.properties file."/>
        <available file="${jboss.deploy.directory}" type="dir" property="container.present"/>
        <fail unless="container.present" message="Deploy directory ${jboss.deploy.directory} not available."/>

        <ant target="jar" dir="pa-ejb"/>
        <ant target="war" dir="pa-web"/>
    </target>

	<!-- ====================================================================== -->
    <!-- Run integration tests                                                  -->
    <!-- ====================================================================== -->

    <target name="test-integration" description="Tests the deployed application">
        <ant target="test-all" dir="pa-ear"/>
     </target>

	<!-- ====================================================================== -->
	<!-- Help target                                                            -->
	<!-- ====================================================================== -->

	<target name="help">
		<echo message="Please run: $ant -projecthelp"/>
	</target>
</project>