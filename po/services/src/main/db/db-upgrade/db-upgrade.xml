<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog/1.7"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog/1.7
    http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.7.xsd">
    <preConditions>
        <dbms type="postgresql" />
    </preConditions>
    <changeSet id="PO-787" author="smiller">
       <comment>Upgrade for PO-787 - ctep oids</comment>
       <sqlFile path="${db-upgrade.run.dir}/postgresql/1.1/ctepOids.sql"/>
    </changeSet>
    <changeSet id="PO-933" author="smatyas">
       <comment>Upgrade for PO-933 - setting organization.name and organizationcr.name lengths to 160</comment>
       <sqlFile path="${db-upgrade.run.dir}/postgresql/2.1/PO-933.sql"/>
    </changeSet>
    <changeSet id="PO-1119" author="smatyas">
       <comment>Upgrade for PO-1119 - dropping auditlogdetail.foreignkey column </comment>
       <sqlFile path="${db-upgrade.run.dir}/postgresql/2.2/PO-1119.sql"/>
    </changeSet>
    <changeSet id="PO-893" author="slustbader">
       <comment>Upgrade for PO-893 - organization generic contact</comment>
       <sqlFile path="${db-upgrade.run.dir}/postgresql/2.2/PO-893.sql"/>
    </changeSet>
    <changeSet id="PO-1189" author="slustbader">
       <comment>Upgrade for PO-1189 - new organizational contact types</comment>
       <sqlFile path="${db-upgrade.run.dir}/postgresql/2.2/PO-1189.sql"/>
    </changeSet>
    <changeSet id="PO-1214" author="smatyas">
       <comment>Upgrade for PO-1214 - adding postal address and telecoms to HealthCareFacility and ResearchOrganizaiton</comment>
       <sqlFile path="${db-upgrade.run.dir}/postgresql/3.0/PO-1214.sql"/>
    </changeSet>
    <changeSet id="PO-1199" author="slustbader">
       <comment>Upgrade for PO-1199 - set of otherIdentifiers on correlations</comment>
       <sqlFile path="${db-upgrade.run.dir}/postgresql/3.0/PO-1199.sql"/>
    </changeSet>
    <changeSet id="PO-1213" author="slustbader">
       <comment>Upgrade for PO-1213 - adding person props sex, race, ethnic codes, birthdatw</comment>
       <sqlFile path="${db-upgrade.run.dir}/postgresql/3.0/PO-1213.sql"/>
    </changeSet>
    <changeSet id="PO-1213-2" author="mshestopalov">
       <comment>Upgrade for PO-1213 - adding indexes for person bio fields</comment>
       <sqlFile path="${db-upgrade.run.dir}/postgresql/3.0/PO-1213-2.sql"/>
    </changeSet>
    <changeSet id="PO-1241" author="mshestopalov">
       <comment>Upgrade for PO-1241 - adding patient role</comment>
       <sqlFile path="${db-upgrade.run.dir}/postgresql/3.0/PO-1241.sql"/>
    </changeSet>
    <changeSet id="PO-1229" author="slustbader">
       <comment>Upgrade for PO-1229 - add CTEP ID to structural role otherIdentifiers</comment>
       <sqlFile path="${db-upgrade.run.dir}/postgresql/3.0/PO-1229.sql"/>
    </changeSet>
    <changeSet id="PO-1309" author="slustbader">
       <comment>Upgrade for PO-1309 - add index on otheridentifier join tables</comment>
       <sqlFile path="${db-upgrade.run.dir}/postgresql/3.0/PO-1309.sql"/>
    </changeSet>
    <changeSet id="PO-1292-cleanup" author="smatyas">
       <comment>Upgrade for PO-1292 - cleans up the broken version of PO-1292.sql if it has already been run</comment>
       <sqlFile path="${db-upgrade.run.dir}/postgresql/3.1/PO-1292-cleanup.sql"/>
    </changeSet>
    <changeSet id="PO-1292" author="smatyas" runOnChange="true">
       <!--  The initial version of this file would have failed on production, so it was corrected.  runOnChange is
             set to true so that the corrected version will be run, even if the broken version had already been run
             (after running the PO-1292-cleanup.sql script). -->
       <comment>Upgrade for PO-1292 - updates to support grid security</comment>
       <sqlFile path="${db-upgrade.run.dir}/postgresql/3.1/PO-1292.sql"/>
    </changeSet>
    <changeSet id="PO-1369" author="slustbader">
       <comment>Upgrade for PO-1309 - Change CTEP org root</comment>
       <sqlFile path="${db-upgrade.run.dir}/postgresql/3.0/PO-1369.sql"/>
    </changeSet>
    <changeSet id="PO-1214-data" author="slustbader">
       <comment>Upgrade for PO-1214 - Setting name for HealthCareFacility and ResearchOrganizaiton based on Organization name</comment>
       <sqlFile path="${db-upgrade.run.dir}/postgresql/3.0/PO-1214-data.sql"/>
    </changeSet>
    <changeSet id="PO-1334" author="kkanchinadam">
       <comment>Upgrade for PO-1334 - add type_id columns to the organizationalcontact and organizationalcontactcr tables.</comment>
       <sqlFile path="${db-upgrade.run.dir}/postgresql/3.1/PO-1334.sql"/>
    </changeSet>
    <changeSet id="PO-1335-oc" author="kkanchinadam">
       <comment>Upgrade for PO-1335 - Procedures for migrating existing type_ids to the organizationalcontact table.. Delete orgcontact_types table.</comment>
       <sqlFile splitStatements="false" path="${db-upgrade.run.dir}/postgresql/3.1/PO-1335-oc.sql"/>
    </changeSet>
    <changeSet id="PO-1335-ocr" author="kkanchinadam">
       <comment>Upgrade for PO-1335 - Procedures for migrating existing type_ids to the organizationalcontactcr table. Delete orgcontactcr_types table.</comment>
       <sqlFile splitStatements="false" path="${db-upgrade.run.dir}/postgresql/3.1/PO-1335-ocr.sql"/>
    </changeSet>
    <changeSet id="PO-1371" author="kkanchinadam">
       <comment>Upgrade for PO-1371 - For the tables - organizationalcontact and organizationalcontactcr - set orgcontacttype_id to code="Site" (if null), alter the orgcontacttype_id column to NOT NULL</comment>
       <sqlFile splitStatements="false" path="${db-upgrade.run.dir}/postgresql/3.1/PO-1371.sql"/>
    </changeSet>
    <changeSet id="PO-1353" author="smatyas">
       <comment>Upgrade for PO-1353 - DDL to be CSM/UPT 4.0.1 compliant</comment>
       <sqlFile path="${db-upgrade.run.dir}/postgresql/3.1/PO-1353.sql"/>
    </changeSet>
</databaseChangeLog>
