<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC
"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
"http://struts.apache.org/dtds/struts-2.0.dtd">

<struts>
    <constant name="struts.devMode" value="${struts.devMode}" />
    <constant name="struts.ui.theme" value="css_xhtml" />
    <package name="default" extends="struts-default">
        <interceptors>

            <interceptor name="nci-commonsParams"
                class="com.fiveamsolutions.nci.commons.web.struts2.interceptor.DisplayTagParametersInterceptor" />

            <interceptor name="nullCollectionElements"
                class="com.fiveamsolutions.nci.commons.web.struts2.interceptor.NullCollectionElementInterceptor" />

            <interceptor name="parameterTrim"
                class="com.fiveamsolutions.nci.commons.web.struts2.interceptor.ParameterTrimInterceptor" />

            <interceptor-stack name="poParamsPrepareParamsStack">
                <interceptor-ref name="logger"/>
                <interceptor-ref name="exception" />
                <interceptor-ref name="alias" />
                <interceptor-ref name="nci-commonsParams" />
                <interceptor-ref name="servletConfig" />
                <interceptor-ref name="prepare" />
                <interceptor-ref name="i18n" />
                <interceptor-ref name="chain" />
                <interceptor-ref name="fileUpload" />
                <interceptor-ref name="checkbox" />
                <interceptor-ref name="staticParams" />
                <interceptor-ref name="nci-commonsParams" />
                <interceptor-ref name="conversionError" />
                <interceptor-ref name="nullCollectionElements" />
                <interceptor-ref name="parameterTrim">
                    <param name="trimToNull">true</param>
                </interceptor-ref>
                <interceptor-ref name="validation">
                    <param name="excludeMethods">input,back,cancel</param>
                </interceptor-ref>
                <interceptor-ref name="workflow">
                    <param name="excludeMethods">input,back,cancel</param>
                </interceptor-ref>
           </interceptor-stack>

            <interceptor-stack name="poDefaultStack">
                <interceptor-ref name="logger"/>
                <interceptor-ref name="exception" />
                <interceptor-ref name="alias" />
                <interceptor-ref name="servletConfig" />
                <interceptor-ref name="prepare" />
                <interceptor-ref name="i18n" />
                <interceptor-ref name="chain" />
                <interceptor-ref name="debugging" />
                <interceptor-ref name="profiling" />
                <interceptor-ref name="fileUpload" />
                <interceptor-ref name="checkbox" />
                <interceptor-ref name="staticParams" />
                <interceptor-ref name="nci-commonsParams" />
                <interceptor-ref name="conversionError" />
                <interceptor-ref name="nullCollectionElements" />
                <interceptor-ref name="parameterTrim">
                    <param name="trimToNull">true</param>
                </interceptor-ref>
                <interceptor-ref name="validation">
                    <param name="excludeMethods">input,back,cancel</param>
                </interceptor-ref>
                <interceptor-ref name="workflow">
                    <param name="excludeMethods">input,back,cancel</param>
                </interceptor-ref>
           </interceptor-stack>

           <interceptor-stack name="poPerMethodValidationStack">
                <interceptor-ref name="logger"/>
                <interceptor-ref name="exception" />
                <interceptor-ref name="alias" />
                <interceptor-ref name="nci-commonsParams" />
                <interceptor-ref name="servletConfig" />
                <interceptor-ref name="prepare" />
                <interceptor-ref name="i18n" />
                <interceptor-ref name="chain" />
                <interceptor-ref name="fileUpload" />
                <interceptor-ref name="checkbox" />
                <interceptor-ref name="staticParams" />
                <interceptor-ref name="nci-commonsParams" />
                <interceptor-ref name="conversionError" />
                <interceptor-ref name="nullCollectionElements" />
                <interceptor-ref name="parameterTrim">
                    <param name="trimToNull">true</param>
                </interceptor-ref>
                <interceptor-ref name="validation">
                    <param name="excludeMethods">input,back,cancel</param>
                    <param name="validateAnnotatedMethodOnly">true</param>
                </interceptor-ref>
                <interceptor-ref name="workflow">
                    <param name="excludeMethods">input,back,cancel</param>
                </interceptor-ref>
           </interceptor-stack>
        </interceptors>

        <default-interceptor-ref name="poParamsPrepareParamsStack" />

        <global-results>
            <result name="error">/error.jsp</result>
            <result name="notYetImplemented">/notYetImplemented.jsp</result>
        </global-results>

        <global-exception-mappings>
            <exception-mapping result="error" exception="java.lang.Throwable" />
        </global-exception-mappings>

        <action name="home">
            <result>/WEB-INF/jsp/home.jsp</result>
        </action>

        <action name="login/login">
            <result>/WEB-INF/jsp/login/login.jsp</result>
        </action>

        <action name="login/logout" class="com.fiveamsolutions.nci.commons.web.struts2.action.LogoutAction" method="logout">
            <result name="success" type="redirect-action">
                <param name="namespace">/</param>
                <param name="actionName">home</param>
            </result>
        </action>
    </package>

    <package name="common" extends="default" abstract="true">
        <action name="**contactable/email/*" class="gov.nih.nci.po.web.contactable.AbstractEditContactListAction$EmailAction" method="{2}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="input">/WEB-INF/jsp/contactable/email.jsp</result>
            <result name="success">/WEB-INF/jsp/contactable/email.jsp</result>
        </action>
        <action name="**contactable/phone/*" class="gov.nih.nci.po.web.contactable.AbstractEditContactListAction$PhoneAction" method="{2}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="input">/WEB-INF/jsp/contactable/phone.jsp</result>
            <result name="success">/WEB-INF/jsp/contactable/phone.jsp</result>
        </action>
        <action name="**contactable/fax/*" class="gov.nih.nci.po.web.contactable.AbstractEditContactListAction$FaxAction" method="{2}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="input">/WEB-INF/jsp/contactable/fax.jsp</result>
            <result name="success">/WEB-INF/jsp/contactable/fax.jsp</result>
        </action>
        <action name="**contactable/tty/*" class="gov.nih.nci.po.web.contactable.AbstractEditContactListAction$TtyAction" method="{2}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="input">/WEB-INF/jsp/contactable/tty.jsp</result>
            <result name="success">/WEB-INF/jsp/contactable/tty.jsp</result>
        </action>
        <action name="**contactable/url/*" class="gov.nih.nci.po.web.contactable.AbstractEditContactListAction$UrlAction" method="{2}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="input">/WEB-INF/jsp/contactable/url.jsp</result>
            <result name="success" >/WEB-INF/jsp/contactable/url.jsp</result>
        </action>    
    </package>

    <package name="protected" namespace="/protected" extends="common">
        <!-- Organization -> Inbox && Person -> Inbox -->
        <action name="curate/search/*" class="gov.nih.nci.po.web.curation.CurateAction" method="{1}">
            <result name="success">/WEB-INF/jsp/curate/{1}.jsp</result>
            <result name="list" type="redirect-action">listAll</result>
        </action>
        <action name="ajax/curate/search/*/*" class="gov.nih.nci.po.web.curation.CurateAction" method="{2}">
            <result name="success">/WEB-INF/jsp/curate/{1}/list.jsp</result>
            <result name="list" type="redirect-action">listAll</result>
        </action>

        <!-- Organization -> Edit/Curate -->
        <action name="organization/curate/*" class="gov.nih.nci.po.web.curation.CurateOrganizationAction" method="{1}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="curate">/WEB-INF/jsp/curate/organization/curate.jsp</result>
            <result name="input">/WEB-INF/jsp/curate/organization/{1}.jsp</result>
            <result name="success" type="redirect-action">
                <param name="namespace">/protected</param>
                <param name="actionName">curate/search/listOrgs</param>
            </result>
        </action>        
        <action name="ajax/organization/curate/*" class="gov.nih.nci.po.web.curation.CurateOrganizationAction" method="{1}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="changeCurrentChangeRequest">/WEB-INF/jsp/curate/organization/crInfo.jsp</result>
        </action>
        
        <!-- Person -> Edit/Curate -->
        <action name="person/curate/*" class="gov.nih.nci.po.web.curation.CuratePersonAction" method="{1}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="curate">/WEB-INF/jsp/curate/person/curate.jsp</result>
            <result name="input">/WEB-INF/jsp/curate/person/{1}.jsp</result>
            <result name="success" type="redirect-action">
                <param name="namespace">/protected</param>
                <param name="actionName">curate/search/listPersons</param>
            </result>
        </action>        
        <action name="ajax/person/curate/*" class="gov.nih.nci.po.web.curation.CuratePersonAction" method="{1}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="changeCurrentChangeRequest">/WEB-INF/jsp/curate/person/crInfo.jsp</result>
        </action>
        
        <!-- Organization -> Search -> Popup Select --> 
        <action name="selector/organization/*" class="gov.nih.nci.po.web.selector.SelectOrganizationAction" method="{1}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="success">/WEB-INF/jsp/selector/organization/search.jsp</result>
            <result name="input">/WEB-INF/jsp/selector/organization/search.jsp</result>
        </action>      
        <action name="ajax/selector/organization/*" class="gov.nih.nci.po.web.selector.SelectOrganizationAction" method="{1}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="success">/WEB-INF/jsp/selector/organization/search.jsp</result>
            <result name="detail">/WEB-INF/jsp/selector/organization/detail.jsp</result>
        </action>            
        <action name="ajax/selector/organization/results/*" class="gov.nih.nci.po.web.selector.SelectOrganizationAction" method="{1}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="success">/WEB-INF/jsp/selector/organization/results.jsp</result>
        </action>      
        
        <!-- Person -> Search -> Popup Select -->      
        <action name="selector/person/*" class="gov.nih.nci.po.web.selector.SelectPersonAction" method="{1}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="success">/WEB-INF/jsp/selector/person/search.jsp</result>
            <result name="input">/WEB-INF/jsp/selector/person/search.jsp</result>
        </action>      
        <action name="ajax/selector/person/*" class="gov.nih.nci.po.web.selector.SelectPersonAction" method="{1}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="success">/WEB-INF/jsp/selector/person/search.jsp</result>
            <result name="detail">/WEB-INF/jsp/selector/person/detail.jsp</result>
        </action>            
        <action name="ajax/selector/person/results/*" class="gov.nih.nci.po.web.selector.SelectPersonAction" method="{1}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="success">/WEB-INF/jsp/selector/person/results.jsp</result>
        </action>            
        
        <!-- Organization -> Search -->
        <action name="search/organization/*" class="gov.nih.nci.po.web.search.SearchOrganizationAction" method="{1}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="success">/WEB-INF/jsp/search/organization/search.jsp</result>
            <result name="input">/WEB-INF/jsp/search/organization/search.jsp</result>
        </action>      
        <action name="ajax/search/organization/*" class="gov.nih.nci.po.web.search.SearchOrganizationAction" method="{1}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="success">/WEB-INF/jsp/search/organization/search.jsp</result>
        </action>            
        <action name="ajax/search/organization/results/*" class="gov.nih.nci.po.web.search.SearchOrganizationAction" method="{1}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="success">/WEB-INF/jsp/search/organization/results.jsp</result>
        </action> 
        
        <!-- Person -> Search -->
        <action name="search/person/*" class="gov.nih.nci.po.web.search.SearchPersonAction" method="{1}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="success">/WEB-INF/jsp/search/person/search.jsp</result>
            <result name="input">/WEB-INF/jsp/search/person/search.jsp</result>
        </action>      
        <action name="ajax/search/person/*" class="gov.nih.nci.po.web.search.SearchPersonAction" method="{1}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="success">/WEB-INF/jsp/search/person/search.jsp</result>
        </action>            
        <action name="ajax/search/person/results/*" class="gov.nih.nci.po.web.search.SearchPersonAction" method="{1}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="success">/WEB-INF/jsp/search/person/results.jsp</result>
        </action> 
        
        <!-- Organization -> Create -->
        <action name="create/organization/*" class="gov.nih.nci.po.web.create.CreateOrganizationAction" method="{1}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="input">/WEB-INF/jsp/curate/organization/curate.jsp</result>
            <result name="success" type="redirect-action">
	            <param name="namespace">/protected</param>
	            <param name="actionName">organization/curate/start</param>
	            <param name="organization.id">${organization.id}</param>
            </result>
        </action>      
        
        <!-- Person -> Create -->
        <action name="create/person/*" class="gov.nih.nci.po.web.create.CreatePersonAction" method="{1}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="input">/WEB-INF/jsp/curate/person/curate.jsp</result>
            <result name="success" type="redirect-action">
	            <param name="namespace">/protected</param>
	            <param name="actionName">person/curate/start</param>
	            <param name="person.id">${person.id}</param>
            </result>
        </action>      
        
        <!-- Organization -> Edit/Curate -> Assign Organizational Roles -->
        <action name="roles/organizational/*/*" class="gov.nih.nci.po.web.roles.{1}Action" method="{2}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="input">/WEB-INF/jsp/roles/organizational/{1}/form.jsp</result>
            <result name="success">/WEB-INF/jsp/roles/organizational/{1}/manage.jsp</result>
        </action>
        <action name="ajax/roles/organizational/*/*" class="gov.nih.nci.po.web.roles.{1}Action" method="{2}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="changeCurrentChangeRequest">/WEB-INF/jsp/roles/organizational/{1}/roleCrInfo.jsp</result>
        </action>
        <action name="ajax/roles/organizational/*/results/*" class="gov.nih.nci.po.web.roles.{1}Action" method="{2}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="success">/WEB-INF/jsp/roles/organizational/{1}/list.jsp</result>
        </action>  
        
        <!-- Person -> Edit/Curate -> Assign Person Roles -->
        <action name="roles/person/*/*" class="gov.nih.nci.po.web.roles.{1}Action" method="{2}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="input">/WEB-INF/jsp/roles/person/{1}/form.jsp</result>
            <result name="success">/WEB-INF/jsp/roles/person/{1}/manage.jsp</result>
        </action>
        <action name="ajax/roles/person/*/*" class="gov.nih.nci.po.web.roles.{1}Action" method="{2}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="changeCurrentChangeRequest">/WEB-INF/jsp/roles/person/{1}/roleCrInfo.jsp</result>
        </action>
        <action name="ajax/roles/person/*/results/*" class="gov.nih.nci.po.web.roles.{1}Action" method="{2}">
            <interceptor-ref name="poPerMethodValidationStack" />
            <result name="success">/WEB-INF/jsp/roles/person/{1}/list.jsp</result>
        </action>  
       
    </package>
</struts>
